<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Parkway ‚Ä¢ Parking Map</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
/* Map-specific asphalt and slot styling */
.lot-grid {
  display:grid; grid-template-columns:1fr 120px 1fr; grid-template-rows:auto 72px auto 72px auto;
  gap:22px; position:relative; padding:28px; border-radius:8px; background:#111;
}
.slot { width:64px; height:96px; border:2px solid #FFD700; border-radius:4px; position:relative; box-shadow: inset 0 -6px 12px rgba(0,0,0,0.3); }
.slot.free { background:#24ff6d; } .slot.occupied { background:#ff5252; } .slot.unknown { background:#ffd056; }
.slot-number { position:absolute; bottom:4px; right:4px; font-size:.65rem; color:#fff; }
.vertical-road { grid-column:2 / 3; grid-row:1 / 6; background:linear-gradient(#444,#333); border-radius:8px; position:relative; }
.vertical-road::after { content:""; position:absolute; left:50%; top:0; width:6px; height:100%; background:repeating-linear-gradient(to bottom, #fff 0 18px, transparent 18px 36px); transform:translateX(-50%);}
.hroad { grid-column:1 / 4; height:72px; background:linear-gradient(#444,#333); position:relative; border-radius:6px; }
.hroad::before { content:""; position:absolute; left:0; top:50%; width:100%; height:6px; background:repeating-linear-gradient(to right, #fff 0 24px, transparent 24px 48px); transform:translateY(-50%);}
.entrance, .exit { position:absolute; top:-22px; left:50%; transform:translateX(-50%); background:#4CAF50;color:#fff;padding:6px 10px;border-radius:6px;font-weight:700;}
.exit { bottom:-22px; background:#F44336; }
</style>
</head>
<body>
<header class="topbar">
  <div class="brand"><a href="index.html">üöó Parkway</a></div>
  <nav class="navlinks">
    <a href="index.html">Home</a>
    <a href="map.html">Parking Map</a>
    <a href="booking.html">My Booking</a>
    <a href="dashboard.html">Dashboard</a>
    <a href="about.html">How It Works</a>
    <a href="contact.html">Contact</a>
  </nav>
</header>

<main class="container">
  <section class="panel glass">
    <div class="panel-head">
      <h2>Live Parking Map</h2>
      <div class="legend">
        <span class="dot free"></span> Free &nbsp;
        <span class="dot occupied"></span> Occupied &nbsp;
        <span class="dot unknown"></span> Unknown
      </div>
    </div>

    <div class="lot-grid" id="parkingLot">
      <div class="vertical-road"></div>

      <!-- Top-left band -->
      <div class="band" style="grid-column:1/2;grid-row:1/2">
        <div class="park-row">
          <div class="slot unknown" id="A1"><span class="slot-number">A1</span></div>
          <div class="slot unknown" id="A2"><span class="slot-number">A2</span></div>
          <div class="slot unknown" id="A3"><span class="slot-number">A3</span></div>
        </div>
      </div>

      <!-- Horizontal road -->
      <div class="hroad" style="grid-column:1/4; grid-row:2/3;"></div>

      <div class="entrance">ENTRANCE</div>
      <div class="exit">EXIT</div>
    </div>
  </section>
</main>

<script>
async function fetchSlots() {
  try {
    const res = await fetch("/api/parking");
    if (!res.ok) throw new Error("Network response not OK");
    const data = await res.json();
    for (const id in data) {
      const el = document.getElementById(id);
      if(!el) continue;
      el.classList.remove("free","occupied","unknown");
      if(data[id]==="EMPTY") el.classList.add("free");
      else if(data[id]==="OCCUPIED") el.classList.add("occupied");
      else el.classList.add("unknown");
    }
  } catch(err){ console.error(err); }
}
setInterval(fetchSlots,1000);
fetchSlots();
</script>

<footer class="site-footer">
  <small>¬©Ô∏è <span id="year"></span> Parkway ‚Ä¢ Smart Parking System</small>
</footer>
<script>document.getElementById('year').textContent = new Date().getFullYear();</script>
</body>
</html>